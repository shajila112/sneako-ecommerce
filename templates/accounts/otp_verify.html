{% extends 'base.html' %}
{% load static %}

{% block content %}
<main class="auth-body">
    <div class="auth-card">
        <div class="auth-logo">SNEAKO</div>

        <div class="auth-header">
            <h2>Verify OTP</h2>
            <p class="text-muted small">
                We've sent a 4-digit code to your email. Please enter it below.
            </p>
        </div>

        <!-- ðŸ”¥ FORM FIXED -->
        <form method="POST" action="{% url 'accounts:otp' %}">
            {% csrf_token %}

            <div class="d-flex justify-content-center gap-2 mb-4">
                <input type="text" name="otp1" class="otp-input form-control"
                       maxlength="1" pattern="[0-9]" required>
                <input type="text" name="otp2" class="otp-input form-control"
                       maxlength="1" pattern="[0-9]" required>
                <input type="text" name="otp3" class="otp-input form-control"
                       maxlength="1" pattern="[0-9]" required>
                <input type="text" name="otp4" class="otp-input form-control"
                       maxlength="1" pattern="[0-9]" required>
            </div>

            <div class="text-center mb-4">
                <p class="small text-muted mb-0">
                    Didn't receive code?
                    <a href="{% url 'accounts:register' %}"
                       class="text-dark fw-bold text-decoration-none">
                        Resend
                    </a>
                </p>
            </div>

            <button type="submit" class="auth-btn">
                Verify & Proceed
            </button>
        </form>

        <div class="auth-link">
            <a href="{% url 'accounts:login' %}">
                Back to Login
            </a>
        </div>
    </div>
</main>

<!-- âœ… KEEP ONLY AUTO-FOCUS JS -->
<script>
    const inputs = document.querySelectorAll('.otp-input');

    inputs.forEach((input, index) => {
        input.addEventListener('input', (e) => {
            if (e.target.value.length === 1 && index < inputs.length - 1) {
                inputs[index + 1].focus();
            }
        });

        input.addEventListener('keydown', (e) => {
            if (e.key === 'Backspace' && !e.target.value && index > 0) {
                inputs[index - 1].focus();
            }
        });
    });
</script>
{% endblock %}
